class Metausuario < Usuario

  has_one :directorio, :foreign_key => :usuario_id, :class_name=> 'Metamares::Directorio'

  after_create :a単ade_directorio, :a単ade_rol

  def dame_usuarios
    usuarios = Metausuario.left_joins(:roles).where("nombre_rol LIKE 'AdminMetamares%'")
    usuarios.map { |u| ["#{u.apellido} #{u.nombre}", u.id]}
  end

  def a単ade_directorio
    directorio.new.save
  end

  def a単ade_rol
    usuario_roles.new({"rol_id"=>"20"}).save
  end
end