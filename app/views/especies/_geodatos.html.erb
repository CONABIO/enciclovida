<% content_for(:extrajs) do %>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" data-turbolinks-track="reload"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.2.0/dist/leaflet.markercluster.js"></script>
  <%= javascript_include_tag 'especies/mapa/mapa', 'data-turbolinks-track' => true %>
<% end %>

<% content_for(:extracss) do %>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
  <link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.2.0/dist/MarkerCluster.Default.css" />
  <%= stylesheet_link_tag 'especies/mapa/mapa', 'data-turbolinks-track' => true %>
<% end %>

<% content_for(:delayedjs) do %>
  <%= javascript_include_tag 'especies/mapa/mapa_delayed', 'data-turbolinks-track' => true %>
<% end %>

<div id="map"></div>

<script data-turbolinks-track="true">
    $(document).ready(function() {
        map = null;
        legend_control = null;
        opciones.snib_url = "<%= @datos[:snib_url] %>";

        markersLayer = L.markerClusterGroup({
            chunkedLoading: true, spiderfyDistanceMultiplier: 2,
            spiderLegPolylineOptions: {weight: 1.5, color: 'white', opacity: 0.5}, which_layer: 'geoportal'
        });
    });
</script>