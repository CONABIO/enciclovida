<% content_for(:extrajs) do %>
  <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js" data-turbolinks-track="true"></script>
  <!--script src="http://cdn.leafletjs.com/leaflet/v1.1.0/leaflet.js" data-turbolinks-track="true"></script-->
  <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js" data-turbolinks-track="true"></script>
    <%= javascript_include_tag "lib/leaflet.markercluster-src.js", "data-turbolinks-track" => true %>
<% end %>

<% content_for(:extracss) do %>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
  <!--link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v1.1.0/leaflet.css" /-->
  <link rel="stylesheet" href="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-draw/v0.2.2/leaflet.draw.css" />
  <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet' />

  <%= stylesheet_link_tag "lib/MarkerCluster.Default", "data-turbolinks-track" => true %>
<% end %>

<%= javascript_include_tag "especies/geodatos", "data-turbolinks-track" => true %>

<div id="map"></div>

<script data-turbolinks-track="true">
	$('#map').css('height', $('#contenedor_mapa').height() - 30);
	$(document).ready(function() {
		$(window).resize(function () {
			$('#map').css('height', $('#contenedor_mapa').height() - 30);
			map.invalidateSize(true);
		});

		//TODO: Poner en el evento cuando se crea el mapa y acomodar este js
		$('#geodata_e_imagen_li > a, #map a.leaflet-control-fullscreen-button').click(function () {
			setTimeout(function(){
				$('#map').css('height', $('#contenedor_mapa').height() - 30);
				map.invalidateSize(true);
			},1000);
		});
	});
</script>